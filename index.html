<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Shehadeh Center â€” Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg: #f5f7fb;
  --card: #ffffff;
  --muted: #6b7280;
  --accent: #0b78ff;
  --accent-2: #0bd3b0;
  --danger: #ef4444;
  --radius: 14px;
  --shadow: 0 8px 24px rgba(16,24,40,0.08);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;padding:0;background:var(--bg);font-family:'Cairo',sans-serif;color:#0f1724}
a{color:inherit;text-decoration:none}

/* Topbar */
.topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 20px;background:linear-gradient(90deg,#072b6b,#0b78ff);color:white;box-shadow:var(--shadow);position:sticky;top:0;z-index:40}
.brand{display:flex;align-items:center;gap:12px}
.brand img{width:44px;height:44px;border-radius:8px;object-fit:cover}
.brand h1{margin:0;font-size:18px;font-weight:700}
.controls{display:flex;align-items:center;gap:8px}
.btn{background:transparent;border:none;color:inherit;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
.btn.primary{background:white;color:var(--accent);padding:10px 14px;box-shadow:0 6px 18px rgba(11,120,255,0.12)}
.search{position:relative}
#search-box{width:280px;padding:10px 12px;border-radius:12px;border:none;background:linear-gradient(180deg,#f1f5f9,#eef2ff);outline:none}
.search-suggestions{position:absolute;right:0;top:44px;background:white;box-shadow:var(--shadow);border-radius:10px;overflow:hidden;display:none;z-index:50;max-width:380px}
.search-suggestions div{padding:8px 10px;cursor:pointer}
.search-suggestions div:hover{background:#f1f5f9}

/* Layout */
.container{display:grid;grid-template-columns:1fr 380px;gap:20px;padding:22px;max-width:1200px;margin:20px auto}
@media(max-width:980px){.container{grid-template-columns:1fr 320px}}
@media(max-width:880px){.container{grid-template-columns:1fr;padding:12px}#search-box{width:100%}}

/* Panels */
.panel{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
.categories{display:flex;flex-direction:column;gap:18px}
.category h2{margin:0 0 8px 0;font-size:18px;color:var(--accent)}
.products-grid{display:flex;flex-wrap:wrap;gap:14px}

/* Product card */
.product{width:260px;background:linear-gradient(180deg,#ffffff,#fbfdff);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(11,120,255,0.06);display:flex;flex-direction:column;gap:10px;transition:transform .18s,box-shadow .18s}
.product:hover{transform:translateY(-6px);box-shadow:0 16px 36px rgba(11,120,255,0.08)}
.product img{width:100%;height:160px;object-fit:cover;border-radius:8px}
.product .meta{display:flex;justify-content:space-between;align-items:center;gap:8px}
.product .name{font-weight:700;color:#0b2b50}
.product .price{color:var(--accent);font-weight:800}
.add-to-cart-btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:white;padding:10px;border-radius:10px;cursor:pointer;font-weight:700}

/* Screens category list style (no images) */
.category-screens .products-grid{flex-direction:column}
.category-screens .product{flex-direction:row;align-items:center;justify-content:space-between;padding:12px 16px;height:auto}
.category-screens .product img{display:none}
.category-screens .name{font-size:15px}

/* Side cart (panel) */
.cart-panel{position:sticky;top:20px;height:calc(100vh - 40px);overflow:auto}
.cart-box{display:flex;flex-direction:column;gap:12px;padding:14px;border-radius:12px;background:linear-gradient(180deg,#ffffff,#fbfbff);box-shadow:var(--shadow)}
.cart-header{display:flex;justify-content:space-between;align-items:center}
.cart-items{display:flex;flex-direction:column;gap:10px;max-height:50vh;overflow:auto}
.cart-item{display:flex;gap:10px;align-items:center;justify-content:space-between;background:#fff;padding:8px;border-radius:10px;border:1px solid #eef2ff}
.cart-item img{width:48px;height:48px;border-radius:8px;object-fit:cover}
.cart-footer{margin-top:auto;display:flex;flex-direction:column;gap:8px}
.small{font-size:12px;color:var(--muted)}

/* Utilities */
.hidden{display:none!important}
#back-to-top{position:fixed;right:20px;bottom:20px;background:var(--accent);color:white;border:none;border-radius:50%;width:45px;height:45px;display:none;align-items:center;justify-content:center;z-index:60;cursor:pointer;box-shadow:var(--shadow)}
label.small{font-size:13px;color:var(--muted)}
.input-pill{padding:8px;border-radius:10px;border:1px solid #eef2ff}

/* responsive product width */
@media(max-width:700px){.product{width:100%}}
</style>
</head>
<body>

<!-- Topbar -->
<div class="topbar" role="banner">
  <div class="brand">
    <img src="https://i.postimg.cc/VNssYbVS/IMG-1002.jpg" alt="logo">
    <div>
      <h1>Shehadeh Center</h1>
      <div class="small">Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© â€” ØªØ­Ø¯ÙŠØ« Ø¹ØµØ±ÙŠ</div>
    </div>
  </div>

  <div class="controls">
    <div class="search" role="search">
      <input id="search-box" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ Ø£Ùˆ ÙØ¦Ø©..." aria-label="Ø¨Ø­Ø«">
      <div class="search-suggestions" id="search-suggestions"></div>
    </div>

    <div id="file-buttons" class="file-buttons" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬Ø§Øª"></div>
    <button id="toggle-dark" class="btn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">ğŸŒ™</button>
    <button id="show-cart-button" class="btn primary" aria-expanded="false">Ø³Ù„Ø© (<span id="cart-total-top">0.00 â‚ª</span>)</button>
  </div>
</div>

<!-- Main content container -->
<div class="container">
  <main class="main-card">
    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px;flex-wrap:wrap">
        <h2 style="margin:0">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
          <label class="small">ÙÙ„ØªØ± Ø³Ø¹Ø±:</label>
          <input id="price-min" class="input-pill" type="number" placeholder="Ø£Ø¯Ù†Ù‰" style="width:90px">
          <input id="price-max" class="input-pill" type="number" placeholder="Ø£Ø¹Ù„Ù‰" style="width:90px">
          <button id="apply-price-filter" class="btn">ØªØ·Ø¨ÙŠÙ‚</button>
          <button id="clear-filters" class="btn">Ø¥Ø¹Ø§Ø¯Ø©</button>
        </div>
      </div>

      <div id="categories" class="categories"></div>
    </div>
  </main>

  <aside class="cart-panel">
    <div class="cart-box panel">
      <div class="cart-header">
        <div>
          <strong>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</strong>
          <div class="small">Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="export-cart-btn" class="btn" title="ØªØ­Ù…ÙŠÙ„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ù„Ø©">ØªØ­Ù…ÙŠÙ„</button>
          <button id="print-cart-btn" class="btn" title="Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©">Ø·Ø¨Ø§Ø¹Ø©</button>
          <button id="clear-cart-btn" class="btn" title="ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©">âœ–</button>
        </div>
      </div>

      <div id="cart-items" class="cart-items"></div>

      <div class="cart-footer">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="small">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
          <div id="cart-total" style="font-weight:800;color:var(--accent)">â‚ª 0.00</div>
        </div>
        <div style="display:flex;gap:8px">
          <button id="checkout-button" class="add-to-cart-btn" style="flex:1">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
          <button id="hide-cart-button" class="btn">Ø¥Ø®ÙØ§Ø¡</button>
        </div>
      </div>
    </div>
  </aside>
</div>

<!-- Back to top -->
<button id="back-to-top" title="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰">â¬†</button>

<!-- Popup (order form) -->
<div class="popup" id="popup" style="display:none;z-index:9999;position:fixed;inset:0;align-items:center;justify-content:center;">
  <div class="panel" style="max-width:420px;margin:0 auto">
    <h3>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h3>
    <input id="customer-name" type="text" placeholder="Ø§Ù„Ø§Ø³Ù…" style="width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #eef2fb">
    <input id="customer-phone" type="text" placeholder="Ø§Ù„Ù‡Ø§ØªÙ" style="width:100%;padding:10px;margin:8px 0;border-radius:8px;border:1px solid #eef2fb">
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button id="confirm-button" class="add-to-cart-btn">Ø¥Ø±Ø³Ø§Ù„</button>
      <button id="cancel-button" class="btn">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<!-- small default image (data URI) to avoid broken images -->
<img id="__default_img" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='400' height='300'><rect width='100%' height='100%' fill='%23f3f4f6'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='%23888' font-size='18'>ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</text></svg>" style="display:none">

<script>
/* ---------- Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙ‡ÙŠØ¦Ø© ---------- */
const categoriesContainer = document.getElementById('categories');
const cartItemsContainer = document.getElementById('cart-items');
const checkoutButton = document.getElementById('checkout-button');
const popup = document.getElementById('popup');
const confirmButton = document.getElementById('confirm-button');
const cancelButton = document.getElementById('cancel-button');
const customerNameInput = document.getElementById('customer-name');
const customerPhoneInput = document.getElementById('customer-phone');

let products = [];
let cart = JSON.parse(localStorage.getItem('cart') || '[]');

/* ---------- Ø£Ø²Ø±Ø§Ø± Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª (ÙƒØªØ§Ù„ÙˆØ¬Ø§Øª) ---------- */
const fileButtonsContainer = document.getElementById('file-buttons');
const fileButtons = [
  { label: 'Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©', fileName: 'test.md' },
  { label: 'Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª', fileName: 'lcd.md' },
  { label: 'Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª', fileName: 'abc.md' }
];
fileButtons.forEach(b => {
  const btn = document.createElement('button');
  btn.className = 'btn';
  btn.textContent = b.label;
  btn.onclick = () => loadProductsFromFile(b.fileName);
  fileButtonsContainer.appendChild(btn);
});

/* ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø¯Ø¦ÙŠ */
window.addEventListener('load', () => loadProductsFromFile('test.md'));

/* ---------- Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ù…Ù„Ù Ù†ØµÙŠ (Ø®Ø·Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ) ---------- */
/*
  ÙŠÙØªØ±Ø¶ Ø£Ù† ÙƒÙ„ Ø³Ø·Ø± ÙÙŠ Ø§Ù„Ù…Ù„Ù Ø¨Ø§Ù„Ø´ÙƒÙ„:
  Ø§Ù„ÙØ¦Ø©/Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬/Ø§Ù„Ø³Ø¹Ø±/Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ù…Ø³Ø§Ø± Ø§Ù„ØµÙˆØ±Ø©
  Ù…Ø«Ù„: Ù…ÙˆØ¨Ø§ÙŠÙ„/Samsung A14/599.00/https://...
*/
function loadProductsFromFile(fileName){
  products = [];
  fetch(fileName)
    .then(r => {
      if(!r.ok) throw new Error('file not found');
      return r.text();
    })
    .then(data => {
      const lines = data.split(/\r?\n/);
      lines.forEach(line => {
        if(!line.trim()) return;
        const parts = line.split('/');
        // Ø¯Ø¹Ù… Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ "/" Ø¨Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ ÙƒØµÙˆØ±Ø©
        if(parts.length >= 3){
          const category = (parts[0] || '').trim();
          const name = (parts[1] || '').trim();
          const priceRaw = (parts[2] || '').trim();
          let price = parseFloat(priceRaw);
          if(isNaN(price)) price = NaN;
          // Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª ØªÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø¬Ø²Ø¡ 3 ÙØµØ§Ø¹Ø¯Ø§Ù‹
          const image = parts.slice(3).join('/').trim() || '';
          products.push({ category, name, price, image });
        }
      });
      renderCategories();
      createFilterButtons();
      renderCart();
      markScreensCategory(); // ØªØµÙ†ÙŠÙ Ø§Ù„Ø´Ø§Ø´Ø§Øª ÙÙˆØ±Ø§Ù‹
    })
    .catch(err => {
      console.error('Ø®Ø·Ø£ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:', err);
      // Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø³ÙŠØ·Ø©
      categoriesContainer.innerHTML = '<div class="panel">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ù…Ø³Ø§Ø±.</div>';
    });
}

/* ---------- Ø¹Ø±Ø¶ Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª ---------- */
function renderCategories(){
  categoriesContainer.innerHTML = '';
  const categories = [...new Set(products.map(p => p.category))];
  categories.forEach(category => {
    const catDiv = document.createElement('div');
    catDiv.className = 'category panel';
    const title = document.createElement('h2');
    title.textContent = category;
    catDiv.appendChild(title);

    const grid = document.createElement('div');
    grid.className = 'products-grid';

    const catProducts = products.filter(p => p.category === category);
    catProducts.forEach(prod => {
      const card = document.createElement('div');
      card.className = 'product';

      // Ø§Ù„ØµÙˆØ±Ø©
      const img = document.createElement('img');
      img.alt = prod.name;
      img.src = prod.image || document.getElementById('__default_img').src;
      img.onerror = () => { img.src = document.getElementById('__default_img').src; };
      card.appendChild(img);

      // Ø§Ø³Ù… ÙˆØ³Ø¹Ø±
      const meta = document.createElement('div');
      meta.className = 'meta';
      const name = document.createElement('div');
      name.innerHTML = `<div class="name">${prod.name}</div>`;
      const price = document.createElement('div');
      price.innerHTML = `<div class="price">${isNaN(prod.price) ? 'ØºÙŠØ± Ù…ØªÙˆÙØ±' : prod.price.toFixed(2) + ' â‚ª'}</div>`;
      meta.appendChild(name);
      meta.appendChild(price);
      card.appendChild(meta);

      // Ø²Ø± Ø¥Ø¶Ø§ÙØ© / Ø£Ø¯ÙˆØ§Øª ÙƒÙ…ÙŠØ©
      const qtyControls = document.createElement('div');
      qtyControls.className = 'quantity-controls';
      qtyControls.style.display = 'none';
      qtyControls.style.marginTop = '6px';

      const dec = document.createElement('button'); dec.textContent='âˆ’'; dec.className='btn';
      const input = document.createElement('input'); input.type='number'; input.min='1'; input.value='1'; input.style.width='60px'; input.style.padding='8px'; input.style.borderRadius='8px';
      const inc = document.createElement('button'); inc.textContent='+'; inc.className='btn';
      dec.onclick = ()=> changeLocalQuantity(input, -1);
      inc.onclick = ()=> changeLocalQuantity(input, 1);

      qtyControls.appendChild(dec); qtyControls.appendChild(input); qtyControls.appendChild(inc);

      const addBtn = document.createElement('button');
      addBtn.className = 'add-to-cart-btn';
      addBtn.textContent = 'Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©';
      if(isNaN(prod.price)) {
        addBtn.disabled = true;
        addBtn.style.opacity = '0.6';
      } else {
        addBtn.onclick = () => { addToCart(prod, parseInt(input.value || 1)); qtyControls.style.display = 'flex'; addBtn.style.display='none'; };
      }

      // ØªØ­Ù‚Ù‚ Ø¥Ù† Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø³Ù„Ø© Ù…Ù† Ù‚Ø¨Ù„
      const existed = cart.find(i=> i.name === prod.name);
      if(existed){ qtyControls.style.display='flex'; addBtn.style.display='none'; input.value = existed.quantity; }

      card.appendChild(qtyControls);
      card.appendChild(addBtn);

      grid.appendChild(card);
    });

    catDiv.appendChild(grid);
    categoriesContainer.appendChild(catDiv);
  });

  // Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶ØŒ Ø¹Ù„Ù‘Ù… ÙØ¦Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø§Øª
  markScreensCategory();
}

/* ---------- ÙÙ„ØªØ± / Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØ¦Ø§Øª ---------- */
function createFilterButtons(){
  // Ù‡Ø°Ù‡ ÙˆØ¸ÙŠÙØ© Ø¨Ø³ÙŠØ·Ø©: Ù„Ù†ØºÙŠØ± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø¥Ù† Ø£Ø±Ø¯Ù†Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
  // (Ø¥Ø¨Ù‚ÙŠØªÙ‡Ø§ Ø³Ù‡Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)
}

/* ---------- Ø¨Ø­Ø« Ø°ÙƒÙŠ Ù…Ø¹ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ---------- */
const searchBox = document.getElementById('search-box');
const suggestions = document.getElementById('search-suggestions');
searchBox.addEventListener('input', ()=>{
  const q = searchBox.value.toLowerCase().trim();
  suggestions.innerHTML = '';
  if(q.length < 1){ suggestions.style.display = 'none'; renderCategories(); return; }
  const matches = products.filter(p => (p.name + ' ' + p.category).toLowerCase().includes(q)).slice(0,8);
  matches.forEach(m => {
    const e = document.createElement('div'); e.textContent = `${m.name} â€” ${isNaN(m.price)? 'ØºÙŠØ± Ù…ØªÙˆÙØ±' : m.price.toFixed(2) + ' â‚ª'}`;
    e.onclick = () => { searchBox.value = m.name; suggestions.style.display='none'; renderFilteredProducts([m]); };
    suggestions.appendChild(e);
  });
  suggestions.style.display = matches.length ? 'block' : 'none';
});

function renderFilteredProducts(list){
  // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¹Ø·Ø§Ø© (Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ renderCategories Ù„ÙƒÙ†Ù‡ Ø£Ø¨Ø³Ø·)
  categoriesContainer.innerHTML = '';
  // Ù†Ø¬Ù…Ø¹ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
  const cats = [...new Set(list.map(p=>p.category))];
  cats.forEach(category=>{
    const catDiv = document.createElement('div'); catDiv.className='category panel';
    const title = document.createElement('h2'); title.textContent = category; catDiv.appendChild(title);
    const grid = document.createElement('div'); grid.className='products-grid';
    list.filter(p=>p.category===category).forEach(prod=>{
      const card = document.createElement('div'); card.className='product';
      const img = document.createElement('img'); img.alt = prod.name; img.src = prod.image || document.getElementById('__default_img').src;
      img.onerror = ()=> img.src = document.getElementById('__default_img').src;
      card.appendChild(img);
      const meta = document.createElement('div'); meta.className='meta';
      meta.innerHTML = `<div class="name">${prod.name}</div><div class="price">${isNaN(prod.price)? 'ØºÙŠØ± Ù…ØªÙˆÙØ±' : prod.price.toFixed(2) + ' â‚ª'}</div>`;
      card.appendChild(meta);
      // simplified add button
      const addBtn = document.createElement('button'); addBtn.className='add-to-cart-btn'; addBtn.textContent='Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©';
      if(isNaN(prod.price)) addBtn.disabled=true; else addBtn.onclick = ()=> { addToCart(prod,1); renderCart(); };
      card.appendChild(addBtn);
      grid.appendChild(card);
    });
    catDiv.appendChild(grid);
    categoriesContainer.appendChild(catDiv);
  });
}

/* ---------- ÙÙ„ØªØ± Ø¨Ø§Ù„Ø³Ø¹Ø± ---------- */
document.getElementById('apply-price-filter').addEventListener('click', ()=>{
  const min = parseFloat(document.getElementById('price-min').value || 0);
  const maxVal = document.getElementById('price-max').value;
  const max = maxVal === '' ? Infinity : parseFloat(maxVal);
  const filtered = products.filter(p => !isNaN(p.price) && p.price >= min && p.price <= max);
  if(filtered.length) renderFilteredProducts(filtered);
  else renderCategories();
});
document.getElementById('clear-filters').addEventListener('click', ()=>{ document.getElementById('price-min').value=''; document.getElementById('price-max').value=''; renderCategories(); });

/* ---------- ØªØ¹Ø¯ÙŠÙ„ ÙƒÙ…ÙŠØ© Ù…Ø­Ù„ÙŠØ© (Â±) ---------- */
function changeLocalQuantity(input, delta){
  let n = parseInt(input.value || 1) + delta;
  if(n < 1) n = 1;
  input.value = n;
}

/* ---------- Ø³Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡: Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù/ØªØ­Ø¯ÙŠØ« ---------- */
function addToCart(product, quantity){
  quantity = parseInt(quantity) || 1;
  const exist = cart.find(i => i.name === product.name);
  if(exist){ exist.quantity += quantity; }
  else { cart.push({...product, quantity}); }
  saveCart(); renderCart();
}

function removeFromCart(productName){
  cart = cart.filter(i => i.name !== productName);
  saveCart(); renderCart();
}

function saveCart(){
  localStorage.setItem('cart', JSON.stringify(cart));
}

function renderCart(){
  cartItemsContainer.innerHTML = '';
  let total = 0;
  cart.forEach(item=>{
    const itm = document.createElement('div'); itm.className = 'cart-item';
    const left = document.createElement('div'); left.style.display='flex'; left.style.alignItems='center'; left.style.gap='8px';
    const img = document.createElement('img'); img.src = item.image || document.getElementById('__default_img').src; img.onerror = ()=> img.src = document.getElementById('__default_img').src;
    const txt = document.createElement('div'); txt.innerHTML = `<div style="font-weight:700">${item.name}</div><div class="small">${item.category}</div>`;
    left.appendChild(img); left.appendChild(txt);

    const right = document.createElement('div'); right.style.textAlign='right';
    const qtyInput = document.createElement('input'); qtyInput.type='number'; qtyInput.value = item.quantity; qtyInput.min = 1; qtyInput.style.width='70px'; qtyInput.addEventListener('change', (e)=> {
      const val = parseInt(e.target.value) || 1;
      item.quantity = val; saveCart(); renderCart();
    });
    const priceText = document.createElement('div'); priceText.innerHTML = `â‚ª ${(item.price * item.quantity).toFixed(2)}`;
    const removeBtn = document.createElement('button'); removeBtn.className='btn'; removeBtn.innerHTML='Ø­Ø°Ù'; removeBtn.onclick = ()=> removeFromCart(item.name);
    right.appendChild(priceText); right.appendChild(qtyInput); right.appendChild(removeBtn);

    itm.appendChild(left); itm.appendChild(right);
    cartItemsContainer.appendChild(itm);

    total += (isNaN(item.price)? 0 : item.price * item.quantity);
  });

  document.getElementById('cart-total').textContent = `â‚ª ${total.toFixed(2)}`;
  document.getElementById('cart-total-top').textContent = `${total.toFixed(2)} â‚ª`;
}

/* ---------- ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒØ§ØªÙŠØ¬ÙˆØ±ÙŠ Ø´Ø§Ø´Ø§Øª (Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±) ---------- */
function markScreensCategory(){
  document.querySelectorAll('.category').forEach(cat=>{
    const title = cat.querySelector('h2')?.textContent?.trim() || '';
    if(title.includes('Ø´Ø§Ø´') || title.includes('Ø´Ø§Ø´Ø©') || title.toLowerCase().includes('screens')) {
      cat.classList.add('category-screens');
    } else {
      cat.classList.remove('category-screens');
    }
  });
}

/* ---------- Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ù„Ø© ÙÙˆØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„ ---------- */
renderCart();

/* ---------- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰ ---------- */
const backBtn = document.getElementById('back-to-top');
window.addEventListener('scroll', ()=> {
  if(window.scrollY > 300) backBtn.style.display = 'flex'; else backBtn.style.display = 'none';
});
backBtn.addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));

/* ---------- ØªØµØ¯ÙŠØ± Ø§Ù„Ø³Ù„Ø© ÙƒÙ€ JSON ---------- */
document.getElementById('export-cart-btn').addEventListener('click', ()=>{
  const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(cart,null,2));
  const a = document.createElement('a'); a.href = dataStr; a.download='cart.json'; document.body.appendChild(a); a.click(); a.remove();
});

/* ---------- Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ---------- */
document.getElementById('print-cart-btn').addEventListener('click', ()=>{
  let html = '<h3>ÙØ§ØªÙˆØ±Ø© Ø·Ù„Ø¨</h3><hr>';
  cart.forEach(i => { html += `<div>${i.name} x ${i.quantity} = â‚ª ${ (i.price*i.quantity).toFixed(2) }</div>`; });
  html += `<hr><div><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: â‚ª ${cart.reduce((s,i)=>s + (i.price * i.quantity || 0),0).toFixed(2)}</strong></div>`;
  const w = window.open('','print'); w.document.write('<meta charset="utf-8"><title>ÙØ§ØªÙˆØ±Ø©</title>' + html); w.document.close(); w.print();
});

/* ---------- ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø© ---------- */
document.getElementById('clear-cart-btn').addEventListener('click', ()=>{
  if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©ØŸ')){ cart = []; saveCart(); renderCart(); }
});

/* ---------- Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨ Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ ---------- */
document.getElementById('show-cart-button').addEventListener('click', ()=> {
  // Ø§ÙØªØ­/Ø§ØºÙ„Ù‚ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨
  popup.style.display = 'flex';
});

// Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø²Ø± "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨"
checkoutButton.addEventListener('click', ()=> { popup.style.display = 'flex'; });

confirmButton.addEventListener('click', ()=> {
  const customerName = customerNameInput.value.trim();
  const customerPhone = customerPhoneInput.value.trim();
  if(!customerName || !customerPhone){ alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ.'); return; }

  // ØªØ¬Ù…ÙŠØ¹ Ù†Øµ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
  let text = `â­ï¸ Shehadeh Centre â€” Ø·Ù„Ø¨ÙŠØ© â­ï¸\n`;
  text += `-------------------------\n`;
  text += `Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customerName}\n`;
  text += `Ø§Ù„Ù‡Ø§ØªÙ: ${customerPhone}\n`;
  text += `-------------------------\n`;
  let total = 0;
  cart.forEach(i=>{
    const itemTotal = (i.price || 0) * (i.quantity || 1);
    total += itemTotal;
    text += `${i.category} - ${i.name}\n${i.quantity} x ${ (i.price || 0).toFixed(2) } = ${ itemTotal.toFixed(2) } â‚ª\n`;
    text += '-------------------------\n';
  });
  text += `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toFixed(2)} â‚ª\n`;
  text += `Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±ÙƒÙ…!\n`;

  // Ø§ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø±Ù‚Ù…Ùƒ (Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø±Ù‚Ù… Ø¥Ù„Ù‰ Ø±Ù‚Ù…Ùƒ)
  const phoneNumber = '972566888825'; // Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªØºÙŠÙŠØ±Ù‡
  const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(text)}`;
  window.open(url, '_blank');

  // Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  cart = []; saveCart(); renderCart();
  popup.style.display = 'none';
});

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨
cancelButton.addEventListener('click', ()=> popup.style.display = 'none');
window.addEventListener('click', (e)=> { if(e.target === popup) popup.style.display = 'none'; });

/* ---------- ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ Ø¨Ø³ÙŠØ· ---------- */
document.getElementById('toggle-dark').addEventListener('click', function(){
  document.documentElement.classList.toggle('dark-mode');
  if(document.documentElement.classList.contains('dark-mode')){
    document.documentElement.style.setProperty('--bg','#061226');
    document.documentElement.style.setProperty('--card','#071127');
    document.documentElement.style.setProperty('--muted','#9aa8bf');
    document.documentElement.style.setProperty('--accent','#7dd3fc');
    this.textContent = 'â˜€ï¸';
  } else {
    document.documentElement.style.setProperty('--bg','#f5f7fb');
    document.documentElement.style.setProperty('--card','#ffffff');
    document.documentElement.style.setProperty('--muted','#6b7280');
    document.documentElement.style.setProperty('--accent','#0b78ff');
    this.textContent = 'ğŸŒ™';
  }
});

/* ---------- Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª ÙˆÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ØªØ¹Ù„ÙŠÙ… Ø´Ø§Ø´Ø§Øª ---------- */
function ensureMarkScreensLater(){ setTimeout(markScreensCategory, 300); }
setInterval(markScreensCategory, 900);

/* ---------- Ù…Ù„Ø§Ø­Ø¸Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ---------- */
/*
  - Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆØ¬ÙˆØ¯ Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Øµ (test.md, lcd.md, abc.md) ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯.
  - ØµÙŠØºØ© ÙƒÙ„ Ø³Ø·Ø±: Ø§Ù„ÙØ¦Ø©/Ø§Ù„Ø§Ø³Ù…/Ø§Ù„Ø³Ø¹Ø±/Ø±Ø§Ø¨Ø·_Ø§Ù„ØµÙˆØ±Ø©
  - Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø£Ø¶Ø¹ Ù„Ùƒ Ù…Ø«Ø§Ù„ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø£ÙŠØ¶Ø§Ù‹ Ø£Ø±Ø³Ù„Ù‡ Ù„Ùƒ.
*/

</script>
</body>
</html>