<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            min-height: 100vh;
        }
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-primary {
            background: linear-gradient(to right, #2563eb, #1d4ed8);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }
        .country-option {
            transition: all 0.3s ease;
            border: 2px solid #e5e7eb;
        }
        .country-option:hover {
            transform: translateY(-3px);
            border-color: #3b82f6;
        }
        .country-option.selected {
            border-color: #2563eb;
            background: linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.2);
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center p-4 min-h-screen">
    <div class="w-full max-w-md mx-auto">
        <!-- Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
        <div class="text-center mb-8">
            <div class="inline-block p-4 bg-white/10 backdrop-blur-sm rounded-2xl mb-4">
                <div class="text-3xl">ğŸ”</div>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ Ø§Ù„Ø¢Ù…Ù†</h1>
            <p class="text-blue-100">Ø§Ø®ØªØ± Ø±Ù…Ø² ÙˆØ§ØªØ³Ø§Ø¨ ÙˆØ£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ</p>
        </div>

        <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div class="card rounded-2xl shadow-2xl p-6 mb-6">
            <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… -->
            <div id="system-status" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg hidden">
                <div class="flex items-center">
                    <div class="w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                    <span class="text-green-700 font-medium" id="status-text"></span>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªÙŠØ§Ø± Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø© -->
            <div id="step-country" class="step">
                <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">
                    <i class="fab fa-whatsapp text-green-500 mr-2"></i>
                    Ø§Ø®ØªØ± Ø±Ù…Ø² ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
                </h2>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <!-- Ø±Ù…Ø² 972 -->
                    <div 
                        id="country-972" 
                        class="country-option p-4 rounded-lg cursor-pointer text-center selected"
                        onclick="selectCountry('972')"
                    >
                        <div class="text-4xl mb-3">ğŸ‡µğŸ‡¸</div>
                        <h3 class="font-bold text-gray-800 mb-1">+972</h3>
                        <p class="text-sm text-gray-600">ÙÙ„Ø³Ø·ÙŠÙ† - Ù…Ø¹Ø¸Ù… Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</p>
                        <div class="mt-3">
                            <span class="inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                                ØªØ¨Ø¯Ø£ Ø¨Ù€ 59 Ø£Ùˆ 56
                            </span>
                        </div>
                    </div>

                    <!-- Ø±Ù…Ø² 970 -->
                    <div 
                        id="country-970" 
                        class="country-option p-4 rounded-lg cursor-pointer text-center"
                        onclick="selectCountry('970')"
                    >
                        <div class="text-4xl mb-3">ğŸ‡µğŸ‡¸</div>
                        <h3 class="font-bold text-gray-800 mb-1">+970</h3>
                        <p class="text-sm text-gray-600">Ø§Ù„Ø¶ÙØ© Ø§Ù„ØºØ±Ø¨ÙŠØ© ÙˆØºØ²Ø©</p>
                        <div class="mt-3">
                            <span class="inline-block px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full">
                                ØªØ¨Ø¯Ø£ Ø¨Ù€ 59 Ø£Ùˆ 56
                            </span>
                        </div>
                    </div>
                </div>

                <div class="text-center mb-6">
                    <button 
                        onclick="goToPhoneStep()"
                        class="btn-primary text-white font-bold py-3 px-6 rounded-lg inline-flex items-center"
                    >
                        <span>Ø§Ù„ØªØ§Ù„ÙŠ: Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</span>
                        <i class="fas fa-arrow-left mr-2"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ -->
            <div id="step-phone" class="step hidden">
                <h2 class="text-xl font-bold text-gray-800 mb-4 text-center">
                    <i class="fas fa-mobile-alt text-blue-500 mr-2"></i>
                    Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ
                </h2>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© -->
                <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="text-2xl mr-3">ğŸ‡µğŸ‡¸</div>
                            <div>
                                <h3 class="font-bold text-gray-800" id="selected-country-name">ÙÙ„Ø³Ø·ÙŠÙ†</h3>
                                <p class="text-sm text-gray-600">Ø±Ù…Ø² ÙˆØ§ØªØ³Ø§Ø¨: <span id="selected-country-code" class="font-bold">+972</span></p>
                            </div>
                        </div>
                        <button 
                            onclick="goBackToCountry()"
                            class="text-sm text-blue-600 hover:text-blue-800"
                        >
                            <i class="fas fa-edit ml-1"></i>
                            ØªØºÙŠÙŠØ±
                        </button>
                    </div>
                </div>

                <!-- Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ -->
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2 font-medium">
                        Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù…
                    </label>
                    
                    <div class="flex items-center border-2 border-gray-300 rounded-lg overflow-hidden focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-200">
                        <div class="bg-gray-100 px-4 py-3 font-bold text-gray-700 border-r border-gray-300">
                            <span id="country-prefix">+972</span>
                        </div>
                        <input 
                            type="tel" 
                            id="phone-input" 
                            class="flex-1 p-3 outline-none text-center text-xl font-bold"
                            placeholder="59XXXXXXX"
                            dir="ltr"
                            maxlength="9"
                            oninput="validatePhoneInput(this)"
                        >
                    </div>
                    
                    <div class="mt-3 text-center">
                        <p class="text-sm text-gray-600">
                            <span id="phone-hint">Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 5 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù…</span>
                        </p>
                        <div class="flex justify-center space-x-2 mt-2">
                            <button 
                                onclick="setExampleNumber('599123456')"
                                class="text-xs bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200"
                            >
                                Ù…Ø«Ø§Ù„: 599123456
                            </button>
                            <button 
                                onclick="setExampleNumber('569876543')"
                                class="text-xs bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200"
                            >
                                Ù…Ø«Ø§Ù„: 569876543
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ -->
                <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-start">
                        <div class="text-green-500 mt-1 mr-2">âœ…</div>
                        <div>
                            <p class="text-sm text-green-800 font-medium">Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ</p>
                            <p class="text-xs text-green-700 mt-1">
                                Ø³ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª. Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² ØªØ­Ù‚Ù‚.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="space-y-3">
                    <button 
                        id="auto-login-btn" 
                        onclick="autoLogin()"
                        class="btn-primary w-full text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center"
                    >
                        <i class="fas fa-sign-in-alt ml-2"></i>
                        Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
                    </button>
                    
                    <button 
                        onclick="goBackToCountry()"
                        class="w-full border border-gray-300 text-gray-700 font-bold py-3 px-4 rounded-lg"
                    >
                        <i class="fas fa-arrow-right ml-2"></i>
                        Ø±Ø¬ÙˆØ¹: ØªØºÙŠÙŠØ± Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©
                    </button>
                </div>
            </div>

            <!-- ØªØ­Ù…ÙŠÙ„ ÙˆØªÙˆØ¬ÙŠÙ‡ -->
            <div id="step-loading" class="step hidden">
                <div class="text-center py-10">
                    <div class="loading mx-auto mb-4"></div>
                    <h2 class="text-xl font-bold text-gray-800 mb-2" id="loading-title">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù„ÙŠ...</h2>
                    <p class="text-gray-600 mb-6" id="loading-text">
                        ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù…Ùƒ ÙˆØªÙˆØ¬ÙŠÙ‡Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
                    </p>
                    
                    <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</span>
                                <span id="loading-phone" class="font-bold">+972 5XXXXXXXX</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©:</span>
                                <span id="loading-country" class="font-bold">+972</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ:</span>
                                <span class="text-green-600 font-bold">Ù†Ø´Ø·</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="error-message" class="hidden p-4 bg-red-50 border border-red-200 rounded-lg mb-4">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                            <span id="error-text" class="text-red-700"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
        <div class="text-center text-white/80 text-sm mt-6">
            <p>
                <i class="fas fa-shield-alt mr-2"></i>
                <strong>Ù†Ø¸Ø§Ù… Ø¢Ù…Ù†:</strong> ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
            </p>
            <p class="mt-1">
                <i class="fas fa-mobile-alt mr-2"></i>
                Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯ = Ø¬Ù„Ø³Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
            </p>
        </div>
    </div>

    <!-- Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ -->
    <div id="original-site" class="hidden fixed inset-0 bg-white z-50 overflow-y-auto">
        <div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100">
            <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
            <nav class="bg-white shadow-lg">
                <div class="container mx-auto px-4 py-3">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center">
                            <div class="text-2xl text-blue-600 mr-3">ğŸ </div>
                            <h1 class="text-xl font-bold text-gray-800">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ</h1>
                        </div>
                        <div class="flex items-center space-x-4">
                            <span id="user-display" class="text-gray-700"></span>
                            <button 
                                onclick="logoutFromSite()"
                                class="bg-red-100 text-red-700 px-4 py-2 rounded-lg hover:bg-red-200 transition"
                            >
                                <i class="fas fa-sign-out-alt ml-2"></i>
                                ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                            </button>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
            <div class="container mx-auto px-4 py-8">
                <div class="max-w-4xl mx-auto">
                    <!-- Ø¨Ø·Ø§Ù‚Ø© ØªØ±Ø­ÙŠØ¨ -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
                        <div class="text-center mb-6">
                            <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-user-check text-white text-3xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-800 mb-2">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹!</h2>
                            <p class="text-gray-600">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ</p>
                        </div>

                        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© -->
                        <div class="bg-gray-50 rounded-xl p-6 mb-6">
                            <h3 class="font-bold text-gray-800 mb-4 text-lg">
                                <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                                Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù†Ø´Ø·Ø©
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</span>
                                        <span id="site-phone" class="font-bold">+972 5XXXXXXXX</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©:</span>
                                        <span id="site-country" class="font-bold">+972</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">ÙˆÙ‚Øª Ø§Ù„Ø¯Ø®ÙˆÙ„:</span>
                                        <span id="site-login-time" class="font-mono"></span>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù„Ø³Ø©:</span>
                                        <span id="site-session-id" class="font-mono text-sm">session_12345</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Ù†Ø´Ø·Ø©</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-700">Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù„ÙŠ:</span>
                                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">Ù…ÙØ¹Ù„</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-blue-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600 mb-1" id="active-devices">1</div>
                                <p class="text-sm text-gray-600">Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù†Ø´Ø·Ø©</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-green-600 mb-1" id="session-duration">0</div>
                                <p class="text-sm text-gray-600">Ø¯Ù‚Ø§Ø¦Ù‚ Ù…Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-purple-600 mb-1" id="auto-verifications">1</div>
                                <p class="text-sm text-gray-600">ØªØ­Ù‚Ù‚ Ø¢Ù„ÙŠ</p>
                            </div>
                        </div>

                        <!-- ØªØ­Ø°ÙŠØ± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ -->
                        <div id="multi-login-warning" class="hidden bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                            <div class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-yellow-500 text-xl mr-3"></i>
                                <div>
                                    <h4 class="font-bold text-yellow-800 mb-1">ØªØ­Ø°ÙŠØ±: Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ø£Ø®Ø±Ù‰</h4>
                                    <p class="text-sm text-yellow-700">
                                        ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù…Ùƒ. ØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
                        <div class="border-t pt-6">
                            <h3 class="font-bold text-gray-800 mb-4">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù…ÙŠØ²</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg">
                                    <h4 class="font-bold text-blue-800 mb-2">Ù…ÙŠØ²Ø© 1</h4>
                                    <p class="text-sm text-gray-700">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø£Ù…Ø§Ù† ØªØ§Ù….</p>
                                </div>
                                <div class="bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg">
                                    <h4 class="font-bold text-green-800 mb-2">Ù…ÙŠØ²Ø© 2</h4>
                                    <p class="text-sm text-gray-700">Ø¬Ù„Ø³ØªÙƒ Ù…Ø¤Ù…Ù†Ø© Ø¶Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ Ù…Ù† Ø£Ø¬Ù‡Ø²Ø© Ù…Ø®ØªÙ„ÙØ©.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„ -->
                    <div class="text-center">
                        <button 
                            onclick="backToLogin()"
                            class="inline-flex items-center bg-gray-200 text-gray-800 font-bold px-6 py-3 rounded-lg hover:bg-gray-300 transition"
                        >
                            <i class="fas fa-arrow-right ml-2"></i>
                            Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ØªÙƒÙˆÙŠÙ† Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBWfV0Z1yKxJ-lGJHzi5gStMGTE3CNxmMg",
            authDomain: "aasa-8a079.firebaseapp.com",
            projectId: "aasa-8a079",
            storageBucket: "aasa-8a079.firebasestorage.app",
            databaseURL: "https://aasa-8a079-default-rtdb.firebaseio.com",
            messagingSenderId: "849330713582",
            appId: "1:849330713582:web:7a11b11ebdb5cdcc8b14ff",
            measurementId: "G-LY2WSQ21GE"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        let app;
        let auth;
        let database;
        let recaptchaVerifier;

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let selectedCountry = {
            code: "972",
            name: "ÙÙ„Ø³Ø·ÙŠÙ†",
            prefix: "5"
        };

        // Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª Ù„Ù„ØªØ­Ù‚Ù‚
        const STATIC_VERIFICATION_CODE = "382659";

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ù„Ø³Ø§Øª
        let currentSession = {
            phoneNumber: null,
            countryCode: null,
            sessionId: null,
            loginTime: null,
            isActive: false
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const elements = {
            // Ø§Ù„Ø®Ø·ÙˆØ§Øª
            stepCountry: document.getElementById('step-country'),
            stepPhone: document.getElementById('step-phone'),
            stepLoading: document.getElementById('step-loading'),
            originalSite: document.getElementById('original-site'),
            
            // Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
            systemStatus: document.getElementById('system-status'),
            statusText: document.getElementById('status-text'),
            
            // Ø§Ù„Ø®Ø·ÙˆØ© 1
            selectedCountryName: document.getElementById('selected-country-name'),
            selectedCountryCode: document.getElementById('selected-country-code'),
            countryPrefix: document.getElementById('country-prefix'),
            
            // Ø§Ù„Ø®Ø·ÙˆØ© 2
            phoneInput: document.getElementById('phone-input'),
            phoneHint: document.getElementById('phone-hint'),
            
            // Ø§Ù„Ø®Ø·ÙˆØ© 3
            loadingTitle: document.getElementById('loading-title'),
            loadingText: document.getElementById('loading-text'),
            loadingPhone: document.getElementById('loading-phone'),
            loadingCountry: document.getElementById('loading-country'),
            errorMessage: document.getElementById('error-message'),
            errorText: document.getElementById('error-text'),
            
            // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ
            userDisplay: document.getElementById('user-display'),
            sitePhone: document.getElementById('site-phone'),
            siteCountry: document.getElementById('site-country'),
            siteLoginTime: document.getElementById('site-login-time'),
            siteSessionId: document.getElementById('site-session-id'),
            activeDevices: document.getElementById('active-devices'),
            sessionDuration: document.getElementById('session-duration'),
            autoVerifications: document.getElementById('auto-verifications'),
            multiLoginWarning: document.getElementById('multi-login-warning')
        };

        // ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© =====
        function showStatus(message, type = 'info') {
            elements.statusText.textContent = message;
            elements.systemStatus.className = 'mb-6 p-4 rounded-lg';
            
            switch(type) {
                case 'success':
                    elements.systemStatus.classList.add('bg-green-50', 'border-green-200');
                    break;
                case 'error':
                    elements.systemStatus.classList.add('bg-red-50', 'border-red-200');
                    break;
                case 'warning':
                    elements.systemStatus.classList.add('bg-yellow-50', 'border-yellow-200');
                    break;
                default:
                    elements.systemStatus.classList.add('bg-blue-50', 'border-blue-200');
            }
            
            elements.systemStatus.classList.remove('hidden');
        }

        function hideStatus() {
            elements.systemStatus.classList.add('hidden');
        }

        function showError(message) {
            elements.errorText.textContent = message;
            elements.errorMessage.classList.remove('hidden');
        }

        function hideError() {
            elements.errorMessage.classList.add('hidden');
        }

        // ===== Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆÙ„Ø© =====
        function selectCountry(countryCode) {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (countryCode === "972") {
                selectedCountry = {
                    code: "972",
                    name: "ÙÙ„Ø³Ø·ÙŠÙ†",
                    prefix: "5"
                };
            } else if (countryCode === "970") {
                selectedCountry = {
                    code: "970",
                    name: "Ø§Ù„Ø¶ÙØ© Ø§Ù„ØºØ±Ø¨ÙŠØ© ÙˆØºØ²Ø©",
                    prefix: "5"
                };
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            document.querySelectorAll('.country-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.getElementById(`country-${countryCode}`).classList.add('selected');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
            elements.selectedCountryName.textContent = selectedCountry.name;
            elements.selectedCountryCode.textContent = `+${selectedCountry.code}`;
            elements.countryPrefix.textContent = `+${selectedCountry.code}`;
            elements.phoneHint.textContent = `Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ ${selectedCountry.prefix} ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù…`;
        }

        function goToPhoneStep() {
            elements.stepCountry.classList.add('hidden');
            elements.stepPhone.classList.remove('hidden');
            elements.phoneInput.focus();
        }

        function goBackToCountry() {
            elements.stepPhone.classList.add('hidden');
            elements.stepCountry.classList.remove('hidden');
        }

        // ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ =====
        function validatePhoneInput(input) {
            let value = input.value;
            
            // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·
            value = value.replace(/\D/g, '');
            
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ù‚Ù…
            if (!value.startsWith(selectedCountry.prefix)) {
                value = selectedCountry.prefix + value.replace(selectedCountry.prefix, '');
            }
            
            // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 9 Ø£Ø±Ù‚Ø§Ù…
            if (value.length > 9) {
                value = value.substring(0, 9);
            }
            
            input.value = value;
            
            // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø­Ù‚Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØµØ­Ø©
            if (value.length === 9 && value.startsWith(selectedCountry.prefix)) {
                input.classList.add('border-green-500');
                input.classList.remove('border-red-500');
            } else {
                input.classList.add('border-red-500');
                input.classList.remove('border-green-500');
            }
        }

        function setExampleNumber(number) {
            elements.phoneInput.value = number;
            validatePhoneInput(elements.phoneInput);
        }

        // ===== Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ =====
        async function autoLogin() {
            const phoneNumber = elements.phoneInput.value.trim();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ù‚Ù…
            if (phoneNumber.length !== 9 || !phoneNumber.startsWith(selectedCountry.prefix)) {
                showStatus('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 9 Ø£Ø±Ù‚Ø§Ù… ÙˆÙŠØ¨Ø¯Ø£ Ø¨Ù€ ' + selectedCountry.prefix, 'error');
                return;
            }
            
            const fullPhoneNumber = `+${selectedCountry.code}${phoneNumber}`;
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            elements.stepPhone.classList.add('hidden');
            elements.stepLoading.classList.remove('hidden');
            
            elements.loadingPhone.textContent = fullPhoneNumber;
            elements.loadingCountry.textContent = `+${selectedCountry.code}`;
            
            hideError();
            
            try {
                // Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
                showStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©...', 'info');
                elements.loadingTitle.textContent = 'Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©';
                elements.loadingText.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±';
                
                const isAlreadyLoggedIn = await checkActiveSessions(fullPhoneNumber);
                
                if (isAlreadyLoggedIn) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©ØŒ ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚Ù‡Ø§
                    showStatus('ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø© Ø£Ø®Ø±Ù‰ØŒ Ø¬Ø§Ø±ÙŠ Ø¥ØºÙ„Ø§Ù‚Ù‡Ø§...', 'warning');
                    await logoutOtherSessions(fullPhoneNumber);
                }
                
                // Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù„ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª
                showStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù„ÙŠ...', 'info');
                elements.loadingTitle.textContent = 'Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø¢Ù„ÙŠ';
                elements.loadingText.textContent = 'ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª';
                
                await verifyWithStaticCode(fullPhoneNumber);
                
                // Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø¬Ø¯ÙŠØ¯Ø©
                showStatus('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø¢Ù…Ù†Ø©...', 'info');
                elements.loadingTitle.textContent = 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©';
                elements.loadingText.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø¬Ù„Ø³Ø© Ø¢Ù…Ù†Ø© Ù„Ùƒ';
                
                const sessionId = await createSession(fullPhoneNumber);
                
                // Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ
                showStatus('Ø¬Ø§Ø±ÙŠ ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹...', 'success');
                elements.loadingTitle.textContent = 'Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹';
                elements.loadingText.textContent = 'Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ';
                
                setTimeout(() => {
                    showOriginalSite(fullPhoneNumber, sessionId);
                }, 2000);
                
            } catch (error) {
                console.error('Login error:', error);
                showError(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„: ${error.message}`);
                elements.loadingTitle.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£';
                elements.loadingText.textContent = 'ÙØ´Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                
                setTimeout(() => {
                    elements.stepLoading.classList.add('hidden');
                    elements.stepPhone.classList.remove('hidden');
                }, 3000);
            }
        }

        // ===== Firebase Operations =====
        async function checkActiveSessions(phoneNumber) {
            try {
                if (!database) return false;
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù…
                const sessionsRef = database.ref('sessions/' + btoa(phoneNumber));
                const snapshot = await sessionsRef.once('value');
                
                return snapshot.exists() && snapshot.val().isActive === true;
                
            } catch (error) {
                console.error('Error checking sessions:', error);
                return false;
            }
        }

        async function logoutOtherSessions(phoneNumber) {
            try {
                if (!database) return;
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                const sessionsRef = database.ref('sessions/' + btoa(phoneNumber));
                await sessionsRef.update({
                    isActive: false,
                    logoutTime: new Date().toISOString(),
                    logoutReason: 'new_login_attempt'
                });
                
                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                await sessionsRef.child('notifications').push({
                    type: 'forced_logout',
                    message: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±',
                    timestamp: new Date().toISOString()
                });
                
            } catch (error) {
                console.error('Error logging out other sessions:', error);
            }
        }

        async function verifyWithStaticCode(phoneNumber) {
            try {
                if (!auth) {
                    // ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¯ÙˆÙ† Firebase
                    console.log('Test verification for:', phoneNumber);
                    return true;
                }
                
                // Ø¥Ù†Ø´Ø§Ø¡ reCAPTCHA Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                if (!recaptchaVerifier) {
                    recaptchaVerifier = new firebase.auth.RecaptchaVerifier('auto-login-btn', {
                        'size': 'invisible',
                        'callback': () => console.log('reCAPTCHA solved')
                    });
                }
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚
                const confirmationResult = await auth.signInWithPhoneNumber(phoneNumber, recaptchaVerifier);
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª Ù„Ù„ØªØ­Ù‚Ù‚
                await confirmationResult.confirm(STATIC_VERIFICATION_CODE);
                
                return true;
                
            } catch (error) {
                console.error('Verification error:', error);
                
                // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ØŒ Ù†Ø³ØªØ®Ø¯Ù… ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                if (error.code === 'auth/invalid-verification-code') {
                    console.log('Using test mode for verification');
                    return true;
                }
                
                throw error;
            }
        }

        async function createSession(phoneNumber) {
            try {
                const sessionId = 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const loginTime = new Date();
                
                // Ø­ÙØ¸ ÙÙŠ localStorage
                localStorage.setItem('autoLoginSession', JSON.stringify({
                    phoneNumber: phoneNumber,
                    countryCode: selectedCountry.code,
                    sessionId: sessionId,
                    loginTime: loginTime.toISOString(),
                    isActive: true,
                    verificationCode: STATIC_VERIFICATION_CODE // Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª
                }));
                
                // Ø­ÙØ¸ ÙÙŠ Firebase (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹)
                if (database) {
                    const sessionData = {
                        phoneNumber: phoneNumber,
                        countryCode: selectedCountry.code,
                        sessionId: sessionId,
                        loginTime: loginTime.toISOString(),
                        isActive: true,
                        lastActivity: loginTime.toISOString(),
                        userAgent: navigator.userAgent,
                        platform: navigator.platform
                    };
                    
                    await database.ref('sessions/' + btoa(phoneNumber)).set(sessionData);
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                currentSession = {
                    phoneNumber: phoneNumber,
                    countryCode: selectedCountry.code,
                    sessionId: sessionId,
                    loginTime: loginTime,
                    isActive: true
                };
                
                return sessionId;
                
            } catch (error) {
                console.error('Session creation error:', error);
                throw error;
            }
        }

        // ===== Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ =====
        function showOriginalSite(phoneNumber, sessionId) {
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            elements.sitePhone.textContent = phoneNumber;
            elements.siteCountry.textContent = `+${selectedCountry.code}`;
            elements.siteSessionId.textContent = sessionId;
            
            const loginTime = new Date();
            elements.siteLoginTime.textContent = loginTime.toLocaleString('ar-SA');
            elements.userDisplay.textContent = phoneNumber;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹
            elements.stepLoading.classList.add('hidden');
            elements.originalSite.classList.remove('hidden');
            
            // Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
            updateSessionDuration();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©
            checkForMultipleLoginAttempts();
        }

        function updateSessionDuration() {
            if (!currentSession.loginTime) return;
            
            const startTime = new Date(currentSession.loginTime);
            const now = new Date();
            const diffMinutes = Math.floor((now - startTime) / (1000 * 60));
            
            elements.sessionDuration.textContent = diffMinutes;
            
            // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setTimeout(updateSessionDuration, 60000);
        }

        async function checkForMultipleLoginAttempts() {
            try {
                if (!database || !currentSession.phoneNumber) return;
                
                const notificationsRef = database.ref('sessions/' + btoa(currentSession.phoneNumber) + '/notifications');
                notificationsRef.on('child_added', (snapshot) => {
                    const notification = snapshot.val();
                    if (notification.type === 'forced_logout') {
                        elements.multiLoginWarning.classList.remove('hidden');
                    }
                });
                
            } catch (error) {
                console.error('Error checking login attempts:', error);
            }
        }

        // ===== ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ =====
        async function logoutFromSite() {
            try {
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø©
                if (currentSession.phoneNumber && database) {
                    await database.ref('sessions/' + btoa(currentSession.phoneNumber)).update({
                        isActive: false,
                        logoutTime: new Date().toISOString(),
                        logoutReason: 'user_logout'
                    });
                }
                
                // Ø­Ø°Ù Ù…Ù† localStorage
                localStorage.removeItem('autoLoginSession');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                currentSession = {
                    phoneNumber: null,
                    countryCode: null,
                    sessionId: null,
                    loginTime: null,
                    isActive: false
                };
                
                // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
                backToLogin();
                
            } catch (error) {
                console.error('Logout error:', error);
                backToLogin();
            }
        }

        function backToLogin() {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            elements.phoneInput.value = '';
            elements.phoneInput.classList.remove('border-green-500', 'border-red-500');
            elements.multiLoginWarning.classList.add('hidden');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
            elements.originalSite.classList.add('hidden');
            elements.stepCountry.classList.remove('hidden');
            
            hideStatus();
            hideError();
        }

        // ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© =====
        function checkExistingSession() {
            try {
                const savedSession = localStorage.getItem('autoLoginSession');
                if (savedSession) {
                    const session = JSON.parse(savedSession);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø© (Ø£Ù‚Ù„ Ù…Ù† 24 Ø³Ø§Ø¹Ø©)
                    const loginTime = new Date(session.loginTime);
                    const now = new Date();
                    const hoursDiff = (now - loginTime) / (1000 * 60 * 60);
                    
                    if (hoursDiff < 24 && session.isActive) {
                        // Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©ØŒ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹
                        currentSession = {
                            phoneNumber: session.phoneNumber,
                            countryCode: session.countryCode,
                            sessionId: session.sessionId,
                            loginTime: loginTime,
                            isActive: true
                        };
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø«Ø§Ø¨Øª ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
                        if (session.verificationCode) {
                            // ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                        }
                        
                        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙˆÙ„Ø©
                        selectedCountry = {
                            code: session.countryCode,
                            name: session.countryCode === "972" ? "ÙÙ„Ø³Ø·ÙŠÙ†" : "Ø§Ù„Ø¶ÙØ© Ø§Ù„ØºØ±Ø¨ÙŠØ© ÙˆØºØ²Ø©",
                            prefix: "5"
                        };
                        
                        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹
                        showOriginalSite(session.phoneNumber, session.sessionId);
                        return true;
                    } else {
                        // Ø¬Ù„Ø³Ø© Ù…Ù†ØªÙ‡ÙŠØ©ØŒ Ø­Ø°ÙÙ‡Ø§
                        localStorage.removeItem('autoLoginSession');
                    }
                }
            } catch (error) {
                console.error('Session check error:', error);
            }
            
            return false;
        }

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ =====
        async function initializeApp() {
            try {
                // ØªÙ‡ÙŠØ¦Ø© Firebase
                app = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                database = firebase.database();
                
                console.log('Firebase initialized successfully');
                showStatus('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ', 'success');
                
            } catch (error) {
                console.log('Firebase not available, using test mode');
                showStatus('ğŸ”§ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù„ÙŠ Ø¬Ø§Ù‡Ø² (ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±)', 'info');
            }
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
            selectCountry('972');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ù„Ø³Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
            const hasActiveSession = checkExistingSession();
            
            if (!hasActiveSession) {
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ø³ØªÙ…Ø§Ø¹ Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø¬Ù„Ø³Ø§Øª
                setupSessionMonitoring();
            }
        }

        function setupSessionMonitoring() {
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ localStorage (Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰)
            window.addEventListener('storage', (event) => {
                if (event.key === 'autoLoginSession' && !event.newValue) {
                    // ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù…ØªØµÙØ­ Ø¢Ø®Ø±
                    if (currentSession.isActive) {
                        logoutFromSite();
                    }
                }
            });
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>