<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>محرر كاتالوج جدولي</title>
  <style>
    body { font-family: sans-serif; margin: 20px; direction: rtl; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f0f0f0; }
    td[contenteditable] { background-color: #fffbe6; }
    button { margin: 5px; padding: 5px 10px; }
    textarea { width: 100%; height: 150px; direction: ltr; }
  </style>
</head>
<body>

  <h3>محرر كاتالوج</h3>

  <table id="catalogTable">
    <thead>
      <tr>
        <th>الفئة</th>
        <th>الصنف</th>
        <th>السعر</th>
        <th>رابط الصورة</th>
        <th>حذف</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <!-- الصفوف تُضاف ديناميكياً -->
    </tbody>
  </table>

  <button onclick="addRow()">إضافة صف جديد</button>

  <h4>الناتج بصيغة Markdown:</h4>
  <textarea id="outputText" readonly></textarea>

  <script>
    const tableBody = document.getElementById("tableBody");
    const outputText = document.getElementById("outputText");

    function addRow(category = "", item = "", price = "", link = "") {
      const row = document.createElement("tr");

      row.innerHTML = `
        <td contenteditable="true">${category}</td>
        <td contenteditable="true">${item}</td>
        <td contenteditable="true">${price}</td>
        <td contenteditable="true">${link}</td>
        <td><button onclick="this.closest('tr').remove(); updateOutput();">حذف</button></td>
      `;

      tableBody.appendChild(row);
      updateOutput();
    }

    function updateOutput() {
      let lines = [];
      for (let row of tableBody.rows) {
        const cells = row.querySelectorAll("td");
        const values = Array.from(cells).slice(0, 4).map(td => td.innerText.trim());
        if (values.some(val => val)) {
          lines.push(values.join("/"));
        }
      }
      outputText.value = lines.join("\n");
    }

    // تحديث الناتج عند أي تعديل
    tableBody.addEventListener("input", updateOutput);

    // إضافة صف افتراضي عند التشغيل
    addRow("الكترونيات", "كاميرا", "250", "https://link.to/image.jpg");
  </script>

</body>
</html>